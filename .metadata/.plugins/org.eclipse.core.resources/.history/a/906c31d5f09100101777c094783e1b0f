<%@ page language="java" contentType="text/html; charset=UTF-8" pageEncoding="UTF-8"%>
<%@ page import="java.util.ArrayList"%>
<%@ page import="java.util.List"%>
<%@page import="java.awt.PageAttributes.OrientationRequestedType"%>
<%@ page import="java.sql.*"%>
<%@ page import="lib.DB" %>

<%

String sql = "";
Connection conn = null;
Statement st = null;
ResultSet rs = null;

try {
	conn = DB.getConnection();
	
	sql = "SELECT b.*, m.name AS memname, COUNT(c.bidx) AS comment_count FROM board b LEFT JOIN member m ON b.uid = m.uid LEFT JOIN comment c ON b.idx = c.bidx GROUP BY b.idx ORDER BY b.idx DESC limit 5";
	
	
	
	st = conn.createStatement();
	rs = st.executeQuery(sql);
	
}catch(Exception e){ 
    e.printStackTrace();
    out.println(sql);
}

    // 1. 비즈니스 로직: 데이터 생성
    List<String> items = new ArrayList<>();
    items.add("이것은");
    items.add("JSP를 사용한");
    items.add("컨트롤러 역할의");
    items.add("파일입니다.");

    // 2. request 객체에 데이터 저장
    request.setAttribute("itemList", items);

    // 3. 뷰(View) 역할을 하는 JSP로 포워딩
    RequestDispatcher dispatcher = request.getRequestDispatcher("test3.jsp");
    dispatcher.forward(request, response);
%>