<%@page import="javax.servlet.jsp.tagext.TryCatchFinally"%>
<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
<%@ include file="op_top.jsp" %>
<%
String idx = request.getParameter("idx");
String passinput = request.getParameter("passinput");

String sql = "";
Connection conn = null;
Statement st = null;
ResultSet rs = null;
String check = "";

if (login_id == null || login_id.equals("")) {
	try {
		conn = DB.getConnection();
		sql = "SELECT * FROM board WHERE idx='"+idx+"'";
		st = conn.createStatement();
		rs = st.executeQuery(sql);
		rs.next();
		check = rs.getString("pwd");
	}catch (Exception e) {
		e.printStackTrace();
	    out.println(sql);
	}
	
}else {
	try {
		conn = DB.getConnection();
		sql = "SELECT b.*, m.upassword as pass FROM board b left join member m ON b.uid = m.uid WHERE b.idx='"+idx+"'";
		st = conn.createStatement();
		rs = st.executeQuery(sql);
		rs.next();
		check = rs.getString("pass");
	}catch (Exception e) {
		e.printStackTrace();
	    out.println(sql);
	}
}
System.out.println(check);
System.out.println(passinput);
if (passinput.equals(check)) {
	%>
	<script type="text/javascript">
		location.replace("modify.jsp?idx=<%= idx %>");
	</script>
	<%
	return;
}else {
	%>
	<script type="text/javascript">
		alert("비밀번호가 틀렸습니다.");
		location.replace("view.jsp?idx=<%= idx %>");
	</script>
	<%
	return;
}

%>